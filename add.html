<!-- add.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add Product</title>
  <link rel="stylesheet" href="styles.css">
  <!-- Database -->
 
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-analytics.js";
    // TODO: Add SDKs for Database products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Database configuration
    // For Database JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyCskwp6LXirBoO0lnuYfWZyqKMVoqfMcjM",
      authDomain: "cc-mediastore.firebaseapp.com",
      projectId: "cc-mediastore",
      storageBucket: "cc-mediastore.firebasestorage.app",
      messagingSenderId: "755685023978",
      appId: "1:755685023978:web:5b761e81bc846b96103793",
      measurementId: "G-6L0NJVKKEG"
    };
  
    // Initialize Database
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
  </script>
</head>
<body>
  <h1>Add Product</h1>
  <button onclick="openForm()">Add Product</button>

  <div id="form-popup" style="display:none;">
    <form id="product-form">
      <input type="file" id="image-input" accept="image/*" required><br>
      <input type="text" id="name-input" placeholder="Product Name" required><br>
      <input type="text" id="price-input" placeholder="Price (â‚¦)" required><br>
      <textarea id="desc-input" maxlength="300" rows="4" placeholder="Product Description (max 4 lines)"></textarea><br>
      <button type="submit">Submit</button>
    </form>
  </div>

  <div id="product-container"></div>

  <script>
    const form = document.getElementById("product-form");
    const container = document.getElementById("product-container");

    function openForm() {
      document.getElementById("form-popup").style.display = "block";
    }

    function renderProduct(product, id) {
      const card = document.createElement("div");
      card.className = "product-card";
      card.innerHTML = `
        <img src="${product.image}" alt="${product.name}" style="width:100%; height:200px; object-fit:cover;">
        <h3>${product.name}</h3>
        <p>${product.price}</p>
        <p>${product.desc}</p>
        <button onclick="deleteProduct('${id}')">Delete</button>
      `;
      container.appendChild(card);
    }

    function loadProducts() {
      container.innerHTML = "";
      db.collection("products").get().then(snapshot => {
        snapshot.forEach(doc => {
          renderProduct(doc.data(), doc.id);
        });
      });
    }

    function deleteProduct(id) {
      db.collection("products").doc(id).delete().then(() => {
        loadProducts();
      });
    }

    form.addEventListener("submit", function(e) {
      e.preventDefault();
      const name = document.getElementById("name-input").value;
      const price = document.getElementById("price-input").value;
      const desc = document.getElementById("desc-input").value;
      const imageFile = document.getElementById("image-input").files[0];

      const reader = new FileReader();
      reader.onload = function(event) {
        const imageData = event.target.result;
        db.collection("products").add({ name, price, desc, image: imageData }).then(() => {
          form.reset();
          loadProducts();
        });
      };
      reader.readAsDataURL(imageFile);
    });

    window.onload = loadProducts;
  </script>
</body>
</html>
